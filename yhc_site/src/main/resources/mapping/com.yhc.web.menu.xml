<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yhc.web.menu" >
	<cache type="org.mybatis.caches.ehcache.LoggingEhcache" >  
    <property name="timeToIdleSeconds" value="3600"/><!--1 hour-->  
    <property name="timeToLiveSeconds" value="3600"/><!--1 hour-->  
    <property name="maxEntriesLocalHeap" value="1000"/>  
    <property name="maxEntriesLocalDisk" value="10000000"/>  
    <property name="memoryStoreEvictionPolicy" value="LRU"/>  
</cache>
	<select id="getAuthMenuList" parameterType="map" resultType="authMenu">
		select
		txam.am_id amId,
		txam.auth_id authId,
		txam.menu_id menuId,
		txam.del_yn delYn,
		txa.auth_nm authNm,
		txa.auth_type authType,
		txa.del_yn authDelYn,
		txm.parent_menu_nm parentMenuNm,
		txm.menu_nm menuNm,
		txm.menu_uri menuUri,
		txm.menu_tag_nm menuTagNm,
		txm.disp_yn dispYn,
		txm.del_yn menuDelYn
		from tb_xmph_menu txm, tb_xmph_auth_menu txam, tb_xmph_auth txa
		where txa.auth_id = txam.auth_id
		and txam.menu_id = txm.menu_id
		<if test="authId!=null">and txa.auth_id = #{authId}#</if>
		<if test="authDelYn!=null">and txa.del_yn = #{authDelYn}#</if>
		<if test="dispYn!=null">and txm.disp_yn = #{dispYn}#</if>
		<if test="menuDelYn!=null">and txm.del_yn = #{menuDelYn}#</if>
		<if test="delYn!=null">and txam.del_yn = #{delYn}#</if>
		order by txm.parent_menu_nm
	</select>
	<select id="selectPermissionsByRoleId" parameterType="String" resultType="sysMenu">
		select sm.id,sm.permission,
		       sm.name,
		       sm.parent_id as parentId
		from sys_role_menu srm,sys_menu sm
		where sm.is_show='N' and srm.menu_id=sm.id and srm.role_id=#{id}
		
		</select>
	<select id="getSysMenuList" parameterType="map" resultType="authMenu">
		select 
		
		from sys_menu sm,sys_role_menu srm,sys_role sr
		where sr.id=srm.role_id 
		      and srm.menu_id=sm.id
		      and sr.userable='Y'
		      and sr.del_flag='N'
		      and sm.del_flag='N'
		      and sm.is_show='Y'
		    <if test="roleId!=null">
		    	and sr.id = #{roleId}#
		    </if>
	</select>
</mapper>